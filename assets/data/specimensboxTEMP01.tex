\documentclass{article} 

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc} % Input format
\newcommand*{\plogo}{\fbox{$\mathcal{PL}$}} % Generic dummy publisher logo
\usepackage{xltxtra}
\usepackage{polyglossia}

\usepackage{color}
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\usepackage{multirow}
\usepackage{pgffor}
\usepackage{collcell}
\usepackage{ltablex}

% LaTeX code for the invoice.
\usepackage[usegeometry]{typearea}% load before geometry
\usepackage[portrait]{geometry}
 \geometry{
 a4paper,
 total={257mm,170mm},
 left=20mm,
 top=35mm,
 }
\usepackage{array}
\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}

\newenvironment{MyTabular}[2][0]{%
    \renewcommand*{\arraystretch}{1.2}
    \fontsize{9pt}{10.8pt}\selectfont
    \tabularx{\textwidth}{#2}
       \hline% Print header rows
       \multicolumn{2}{|c}{\emph{\textbf{Specimens Number}}} & 
       \multicolumn{2}{|c|}{\emph{\textbf{Genera Info}}} &   \\
       \hline  
       \rowcolor{Gainsboro}  {\textbf{Code}} & \textbf{Year} & \textbf{Order} & \textbf{Family} & 
       \textbf{Total}\\
       \hline
}{%
    \endtabularx%
}

\definecolor{tableShade}{gray}{0.9}
\setlength{\parindent}{0pt}
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{} % clear all header and footer fields 
\renewcommand{\headrulewidth}{0pt}




\setdefaultlanguage{thai}
\newfontfamily{\thaifont}[Script=Thai,
  SizeFeatures={Size=14},
  BoldFeatures={SizeFeatures={Size=14}}, 
  UprightFeatures={SizeFeatures={Size=14}},
  ItalicFeatures={SizeFeatures={Size=14}},
  BoldFeatures={SizeFeatures={Size=14}},
  BoldItalicFeatures={SizeFeatures={Size=14}}]{TH SarabunPSK}
\newcommand{\boldfont}[1]{{%
  \fontsize{10pt}{12pt}\normalfont #1%
}}
\setlength{\headheight}{35pt}


% Make placeholders visible
\newcommand{\placeholder}[1]{\textbf{$<$ #1 $>$}}

% Defaults for each variable
\newcommand{\specimensfullnumber}{\placeholder{specimens_full_number}}
\newcommand{\reportdate}{\placeholder{sreport_date}}
\newcommand{\familyname}{\placeholder{family_name}}
\newcommand{\collboxno}{\placeholder{collboxno}}

\newcommand*{\Data}[1]{% 
      #1\\
      \hline
}%

\begin{document}

% <?php echo "\n" . "\\renewcommand{\\reportdate}{" . LatexTemplate::escape($data[0]['sreport_date']) . "}\n"; ?>
% <?php echo "\n" . "\\renewcommand{\\collboxno}{" . LatexTemplate::escape($data[0]['collboxno']) . "}\n"; ?>

\fancyhead[C]{\begin{tabular}[t]{@{}p{10cm}@{}}
  \hfill \textbf{Specimens \collboxno} \reportdate  \hfill \strut \\
  \\
\end{tabular}}


\newgeometry{hmargin=2.0cm,bottom=45mm,height=240mm,includehead}
\fancyheadoffset{0pt}% recalculate headwidth for fancyhdr
\begin{MyTabular}{|p{4.0cm}|p{2.5cm}|p{3.5cm}|p{3.5cm}|p{1.0cm}|}
\hline 
%<?php                                    /*
% */ foreach($data as $specboxdetails) {           /*
% */  echo "\n" . "\\Data{" . LatexTemplate::escape($specboxdetails['specimens_full_number']) . " & " .  /*  
% */  " " . LatexTemplate::escape($specboxdetails['concatspecno']) . " & ".    /*  
% */  " " . LatexTemplate::escape($specboxdetails['torder_name']) . " & ".    /*
% */  " " . LatexTemplate::escape($specboxdetails['family_name']) . " & ".    /*
% */  " " . LatexTemplate::escape($specboxdetails['collboxno']) . "}\n";    ?>  

%<?php  } ?> 

\end{MyTabular}

\end{document}