\documentclass{article} 
% Required for proper escaping
\usepackage{textcomp} % Symbols

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc} % Input format
\usepackage[usegeometry]{typearea}

\usepackage{color}
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\usepackage{multirow}
\usepackage{pgffor}
\usepackage{collcell}
\usepackage{graphicx}
\usepackage{enumitem}
\setlist{nolistsep}
\definecolor{green}{HTML}{66FF66}
\definecolor{orange}{HTML}{f75414}
\definecolor{myGreen}{HTML}{009900}
\definecolor{myOrange}{HTML}{ff8a6f}



\newcommand*{\plogo}{\fbox{$\mathcal{PL}$}} % Generic dummy publisher logo

\usepackage{xltxtra}
\usepackage{polyglossia}
\XeTeXlinebreaklocale "th"
\XeTeXlinebreakskip = 0pt plus 1pt


\fontspec[
ItalicFont={TH SarabunPSK Italic},
BoldFont={TH SarabunPSK Bold},
BoldItalicFont={TH SarabunPSK Bold Italic},
]{TH SarabunPSK}
\fontsize{18pt}{24pt}\selectfont
% Because Unicode etc. 


% Make placeholders visible
\newcommand{\placeholder}[1]{\textbf{$<$ #1 $>$}}

% Defaults for each variable

\newcommand{\allcount}{\placeholder{allcount}}
\newcommand{\fulldatereport}{\placeholder{fulldatereport}}


% <?php echo "\n" . "\\renewcommand{\\allcount}{" . LatexTemplate::escape($data[0]['allcount']) . "}\n"; ?>
% <?php echo "\n" . "\\renewcommand{\\fulldatereport}{" . LatexTemplate::escape($data[0]['fulldatereport']) . "}\n"; ?>

\usepackage[portrait]{geometry}
 \geometry{
 a4paper,
 total={257mm,170mm},
 left=20mm,
 top=35mm,
 }



\usepackage{array}
\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\usepackage{pdflscape}
\usepackage[svgnames,table]{xcolor}
\usepackage{ltablex}
\usepackage{graphicx}
\usepackage{setspace}

\graphicspath{{E:/xampp/htdocs/Qedatamanagement/packet/LAYOUT-2/assets/images/}}
\definecolor{tableShade}{gray}{0.9}
\setlength{\parindent}{0pt}
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{} % clear all header and footer fields 
\renewcommand{\headrulewidth}{0pt}


\fancyhead[RE,LO]{\begin{tabular}{@{}m{1.3cm}m{5cm}}
  \begin{minipage}{0.25\textwidth}
\includegraphics[width=0.5\textwidth,height=0.5\textwidth]{ENTO-LOGO-WEBAPP} 
\end{minipage} & \begin{minipage}[t]{\linewidth}%
\begin{itemize}
\item[] Queen Sirikit Botanic Garden
\item[] Entomolgy Section
\end{itemize} 
\end{minipage}                 \\
\end{tabular}}


\fancyhead[LE,RO]{ 
\begin{tabular}{@{}m{4cm}m{3cm}@{}}
\arrayrulecolor{orange}\hline
\textbf{\textcolor{orange}{Specimens List Details}} & \\
\hline
REPORT DATE & \fulldatereport  \\
QUANTITY & \allcount  \\
\arrayrulecolor{black}\hline
\end{tabular}
}

\setdefaultlanguage{thai}

\newfontfamily{\thaifont}[Script=Thai,
  SizeFeatures={Size=14},
  BoldFeatures={SizeFeatures={Size=14}}, 
  UprightFeatures={SizeFeatures={Size=14}},
  ItalicFeatures={SizeFeatures={Size=14}},
  BoldFeatures={SizeFeatures={Size=14}},
  BoldItalicFeatures={SizeFeatures={Size=14}}]{TH SarabunPSK}
\newcommand{\boldfont}[1]{{%
  \fontsize{10pt}{12pt}\normalfont #1%
}}
\setlength{\headheight}{45pt}


\usepackage{ltablex}
\usepackage{environ}
\usepackage{lipsum}

\NewEnviron{MyTabularX}[2][0]{%

   \begin{tabularx}{\textwidth}{#2}
    \hline% Print header rows
    
    \BODY
   \end{tabularx}
}

\newcommand*{\Data}[2]{%
    % #1 = Question Text
    % #2 = Univerity group numbers
    % #3 = School Group Numbers
    % #4 = Comparrisons
    %

      \hline
    \rowcolor{Gainsboro}
    \multicolumn{7}{|l|}{#1}  \\
    \hline
    #2\\ \hline
  
  
     
}%


\begin{document}
\newgeometry{hmargin=2.0cm,bottom=45mm,height=240mm,includehead}
\fancyheadoffset{0pt}% recalculate headwidth for fancyhdr


\begin{MyTabularX}{|p{3.0cm}|p{1.0cm}|p{2.5cm}|p{1.5cm}|p{2.0cm}|p{2.3cm}|p{2.3cm}|}
%<?php                                    /*
% */           $i = 0; /*
% */ foreach($data as $specboxdetails) {           /*
% */  echo "\n" . "\\Data{" .LatexTemplate::escape($specboxdetails['torder_name']) .  /*  
% */  " " . LatexTemplate::escape($specboxdetails['family_name']) . "}\n"; ?>
{ \multicolumn{2}{|c|}{\emph{\textbf{Specimens No.}}}    & Box NO. & Row & Cabinet & SubCabinet & Drawer No.}
%<?php                                    /*
% */ foreach($data[$i]['speclist'] as $speclistdetails) {           /*
  % */  echo "\n". LatexTemplate::escape($speclistdetails['coll_full_id']) . " & " . /*
  % */  " " . LatexTemplate::escape($speclistdetails['specimens_number']) . " & ".    /*
  % */  " " . LatexTemplate::escape($speclistdetails['collboxno']) . " & ".    /*
  % */  " " . "" . " & ".    /*
  % */  " " . "" . " & ".    /*
  % */  " " . "" . " & ".    /*
  % */  " " . "" ."\\\\". "\\hline"."\n";   /*
% */ } ?>  



%<?php /*
% */ $i++; /*
% */ } ?> 

\end{MyTabularX}

\textcolor{black}{\rule{17cm}{1mm}} \\
CAUSTION : Please check you the data befor you pull out the specimens from the box
  
\end{document}